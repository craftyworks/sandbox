# Git 기초

## 스냅샷의 스트림

- SVN : 파일의 변화를 시간순으로 관리하면서 파일들의 집합을 관리한다. (델타 기반의 버전관리 시스템)

- Git : Git은 데이터를 파일 시스템 스냅샷의 연속으로 취급한다. Git은 데이터를 스냅샷의 스트림처럼 취급한다. 시간순으로 프로젝트의 스냅샷을 저장

## 모든 명령을 로컬에서 실행

오프라인에서 커밋 가능

## 무결성

 Git은 데이터를 저장하기 전에 항상 체크섬을 구하고 그 체크섬으로 데이터를 관리한다.

Git은 SHA-1 해시를 사용하여 체크섬을 만든다. 체크섬은 40자 길이의 16진수 문자열이다. 파일의 내용이나 디렉토리 구조를 이용해서 체크섬을 구한다.

# Git Architecture

## Key Area

GIt 이 파일의 스냅샷 스트림 정보를 관리하기 위해 3개의 영역을 관리합니다.

1. Working Directory (작업 디렉토리 또는 Working Tree)
2. Staging Area (스테이징 영역 또는 Index)
3. Git Repository (저장소 또는 Git Directory)

### Working Directory
작업 중인 파일이 위치하는 물리적인 디렉토리. 개발자가 파일을 생성하거나 수정, 삭제하는 작업공간

- Git은 로컬 파일 시스템에서 작업 중인 파일과 디렉토리의 상태를 관리한다.

### Staging Area (Index)
커밋할 파일의 변경사항을 임시로 저장하는 영역. git add 명령을 통해 파일을 이 영역에 추가한다.

- Git 은 파일의 변경 내용을 블롭(blob) 형태로 저장하고, 해당 파일의 메타데이터를 스테이징 영역에 기록한다.

- 스테이징 영역은 다음 커밋의 스냅샷을 정의하는 역할을 한다.

### Git Repository
커밋된 파일의 스냅샷의 저장되는 영역.
.git 디렉토리에 모든 이력 정보가 저장된다.

- 커밋을 실행하면 스테이징 영역에 있는 모든 파일의 스냅샷이 GIt 저장소에 등록된다.
- Git 은 각 커밋을 블롭(blod), 트리(tree), 커밋 객체로 구성된 구조로 관리한다.

## 데이터 구조

### Hash
Git 은 파일명이나 경로를 사용하지 않고 파일의 내용을 기준으로 데이터를 관리한다.

파일의 내용 전체를 해시 함수(SHA-1)로 계산해 고유한 해시값(40자리 문자열)을 생성하고 이를 해당 파일의 식별자로 사용한다.

Git 은 파일을 blob 객체로 저장하는데 blob 에는 해시값과 파일 내용이 포함된다.

Git 은 파일 비교시 전체를 비교하지 않고, 해시값만 비교하여 변경여부를 판단한다 .

Git 은 파일 내용뿐 아니라 디렉토리 구조, 커밋 정보 등도 모두 해시값으로 관리ㅏㄴ다.

### 커밋 데이터

커밋이 발생하면 Git 은 다음과 같은 객체를 저장소에 생선한다.

- Blob : 파일 내용과 해시값을 저장
- Tree : 디렉토리 구조를 저장하며, Blob 와 다른 Tree 를 참조
- Commit : 특정 시점의 스냅샷을 저장하며, 이전 Commit 정보와 Tree 를 참조

### 저장 과정

1. 스테이징에 파일 추가
  - a.java 파일의 내용 -> SHA-1 해시 계산 -> blob 생성

2. 트리 생성
 - 스테이징 영역의 상태 기반으로 새로운 트리 생성
 - 변경되지 않은 파일(Blob) 이나 디렉토리(Tree)는 이전에 생성됙 객체를 참조

3. 커밋 생성
  - 커밋 객체를 생성하여 트리를 참조
  - 이전 커밋객체와 연결하여 이력을 기록

### 트리

트리는 커밋 시점에 생성

트리는 워킹 디렉토리 루트부터 모든 하위 디렉토리와 파일을 포함

디렉토리마다 별도의 트리 객체가 생성되며 트리 객체는 하위 트리(디렉토리)와 Blob(파일)을 참조한다.

커밋할 때마다 새로운 트리 객체를 생성. 변경되지 않은 파일과 디렉토리는 기존 객체를 재사용

### 커밋

커밋 객체는 특정 시점의 스냅샷을 나타내며, 하나의 트리를 참조한다.

각 커밋은 이전 커밋과 연결되어 변경 이력을 나타낸다.

# 상태 관리

Git에서 모든 파일은 크게 Tracked 와 Untracked 범주 두 가지 상태로 나누어진다.

## Tracked

Git이 추적하고 있는 파일로, 커밋으로 Git 저장소에 보관되었거나, git add 명령으로 스테이징된 파일이다. Tracked 상태의 파일은 다시 세 가지 하위 상태로 나누어진다.

- Unmodified(수정되지 않음) : 이전 커밋 이후로 변경되지 않음
- Modified(수정됨) : 내용이 변경되었지만 아직 스테이징되지 않은 상태
- Staged(스테이징됨) : git add 명령으로 다음 커밋에 반영될 준비가 된 상태

## Untracked
GIt 이 추적하지 않는 파일로, Working Directory 에 새로 생성된 파일이거나 .gitignore 에 의해 무시된 파일일 수 있다. 

## 상태 전이

1. 파일이 신규로 생성되면 Untracked 상태

2. git add -> Staged 상태

3. git commit -> 스테이징된 파일이 커밋되고 Tracked(Unmodified) 상태

4. 이후 파일이 수정되면 Modified 상태로 변경

5. 다시 git add 를 실행하여 Staged -> git commit 하면 Unmodified

- Untracked -[add]-> Staged
- Staged -[commit]-> Unmodified
- Unmodified -[edit]-> MOdified
- Modified -[add]-> Staged

# 하나의 파일을 각 브랜치별로 다른 내용으로 유지

파일에 대한 mrege 전략을 .gitattributes 에 지정

mrege 할때 충돌을 무시하고 항상 현재 브랜치의 내용을 유지하게 설정


